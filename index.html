<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KTP Generator Web</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            background-color: #f4f7f6;
        }
        /* Sidebar untuk Form */
        .form-container {
            width: 350px;
            padding: 20px;
            background: #ffffff;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            box-sizing: border-box;
        }
        .form-container h2 {
            margin-top: 0;
            font-size: 20px;
            color: #333;
        }
        .input-group {
            display: flex;
            flex-direction: column;
        }
        .input-group label {
            font-size: 12px;
            font-weight: bold;
            color: #555;
            margin-bottom: 4px;
        }
        .input-group input, .input-group select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            position: sticky;
            bottom: 0;
            background: #fff;
            padding-bottom: 10px;
            padding-top: 10px;
        }
        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            color: white;
        }
        .btn-preview {
            background-color: #007bff;
        }
        .btn-preview:hover {
            background-color: #0056b3;
        }
        .btn-random {
            background-color: #28a745;
        }
        .btn-random:hover {
            background-color: #1e7e34;
        }
        /* Area Preview */
        .preview-container {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto;
            box-sizing: border-box;
        }
        iframe {
            width: 100%;
            max-width: 800px;
            height: 600px;
            border: 2px dashed #ccc;
            background: #fff;
            border-radius: 8px;
        }
        .info-text {
            color: #666;
            margin-bottom: 15px;
            font-size: 14px;
        }

        /* Tampilan Responsif untuk HP */
        @media (max-width: 768px) {
            body {
                flex-direction: column;
                height: auto;
            }
            .form-container {
                width: 100%;
                box-shadow: none;
                border-bottom: 2px solid #ddd;
            }
            .preview-container {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <div class="form-container">
        <h2>Input Data KTP</h2>
        
        <div class="input-group">
            <label>Template</label>
            <select id="in_template">
                <option value="1">Template 1 (Standar)</option>
                <option value="2">Template 2 (Varian 1)</option>
                <option value="3">Template 3 (Varian 2)</option>
                <option value="4">Template 4 (HD/Blur Efek)</option>
            </select>
        </div>

        <div class="input-group"><label>Foto Profil (Kosongi untuk foto dummy)</label><input type="file" id="in_photo" accept="image/*"></div>
        <div class="input-group"><label>Provinsi</label><input type="text" id="in_provinsi" value="JAWA TENGAH"></div>
        <div class="input-group"><label>Kabupaten/Kota</label><input type="text" id="in_kabupaten" value="BANJARNEGARA"></div>
        <div class="input-group"><label>NIK</label><input type="text" id="in_nik" value="3304123456789012"></div>
        <div class="input-group"><label>Nama</label><input type="text" id="in_nama" value="NAMA LENGKAP"></div>
        <div class="input-group"><label>Tempat/Tgl Lahir</label><input type="text" id="in_ttl" value="BANJARNEGARA, 01-01-2000"></div>
        <div class="input-group"><label>Jenis Kelamin</label><input type="text" id="in_gender" value="LAKI-LAKI"></div>
        <div class="input-group"><label>Gol. Darah</label><input type="text" id="in_darah" value="-"></div>
        <div class="input-group"><label>Alamat</label><input type="text" id="in_alamat" value="JL. CONTOH ALAMAT NO. 123"></div>
        <div class="input-group"><label>RT/RW</label><input type="text" id="in_rt" value="001/002"></div>
        <div class="input-group"><label>Kel/Desa</label><input type="text" id="in_desa" value="NAMA DESA"></div>
        <div class="input-group"><label>Kecamatan</label><input type="text" id="in_kecamatan" value="NAMA KECAMATAN"></div>
        <div class="input-group"><label>Agama</label><input type="text" id="in_agama" value="ISLAM"></div>
        <div class="input-group"><label>Status Perkawinan</label><input type="text" id="in_status" value="BELUM KAWIN"></div>
        <div class="input-group"><label>Pekerjaan</label><input type="text" id="in_pekerjaan" value="PELAJAR/MAHASISWA"></div>
        <div class="input-group"><label>Kewarganegaraan</label><input type="text" id="in_kewarganegaraan" value="WNI"></div>
        <div class="input-group"><label>Berlaku Hingga</label><input type="text" id="in_berlaku" value="SEUMUR HIDUP"></div>
        <div class="input-group"><label>Tempat Pembuatan</label><input type="text" id="in_dibuat" value="BANJARNEGARA"></div>
        <div class="input-group"><label>Tanggal Pembuatan</label><input type="text" id="in_terbuat" value="01-01-2026"></div>
        <div class="input-group"><label>Tanda Tangan (Teks)</label><input type="text" id="in_sign" value="Ttd"></div>

        <div class="button-group">
            <button class="btn-random" onclick="fillRandomData()">Isi Data Acak</button>
            <button class="btn-preview" onclick="generatePreview()">Buat Preview</button>
        </div>
    </div>

    <div class="preview-container">
        <p class="info-text">Isi data secara manual atau klik "Isi Data Acak", lalu klik "Buat Preview". Screenshot hasil di bawah ini untuk menyimpannya.</p>
        <iframe id="preview-frame"></iframe>
    </div>

    <script>
        // Data template yang SUDAH DIPERBAIKI (tanpa backslash di depan tanda $)
        const templates = [{
            html: (photo, provinsi, kabupaten, nik, nama, ttl, gender, darah, alamat, rt, desa, kecamatan, agama, status, pekerjaan, kewarganegaraan, berlaku, dibuat, terbuat, sign) => `<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><style>@font-face{font-family:'Open Sans Bold';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Bold.ttf') format('truetype')}@font-face{font-family:'Open Sans Regular';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Regular.ttf') format('truetype')}@font-face{font-family:'Bolmand Signature';src:url('https://befonts.com/wp-content/uploads/2025/02/bolmandsignature-0vr8r.ttf') format('truetype')}@font-face{font-family:'Bygone ST Typewriter';src:url('https://befonts.com/wp-content/uploads/2023/01/bygonesttypewriterdemo-4b1dp.otf') format('opentype')}.ktp-container{position:relative;width:720px;height:430px;background-image:url('https://i.pinimg.com/originals/b3/68/ef/b368ef2afb6710cea75fa88371b2cd1e.jpg');background-size:cover;font-family:sans-serif;color:#000;padding:20px;box-sizing:border-box}.lokasi{position:absolute;top:15px;left:50%;transform:translateX(-50%);text-align:center;width:80%}.provinsi,.kabupaten{display:block;font-family:'Open Sans Bold',sans-serif;font-size:28px;line-height:1}.nik-value{position:absolute;top:98px;left:180px;font-family:'Bygone ST Typewriter',monospace;font-size:22px}.info-utama{position:absolute;left:195px;top:139px;font-family:'Open Sans Regular',sans-serif;font-size:16px;line-height:1.4;font-weight:700}.info-kanan{position:absolute;right:60px;font-family:'Open Sans Regular',sans-serif;font-size:16px;line-height:1.4;font-weight:700;text-align:center}.blood-container{top:184px;right:234px}.created-location-container{bottom:60px;right:70px}.created-date-container{bottom:40px;right:67px}.blood,.created-location,.created-date{display:block}.photo-container{position:absolute;top:125px;right:15px;width:178px;height:220px;overflow:hidden;border:1px solid #ccc}.photo{width:100%;height:100%;object-fit:cover}.signature{position:absolute;right:70px;bottom:8px;font-family:'Bolmand Signature',cursive;font-size:30px;font-style:italic}</style></head><body><div class="ktp-container"><div class="lokasi"><div class="provinsi">PROVINSI ${provinsi}</div><div class="kabupaten">KABUPATEN ${kabupaten}</div></div><div class="nik-value">${nik}</div><div class="info-utama"><div>${nama}</div><div>${ttl}</div><div>${gender}</div><div>${alamat}</div><div>${rt}</div><div>${desa}</div><div>${kecamatan}</div><div>${agama}</div><div>${status}</div><div>${pekerjaan}</div><div>${kewarganegaraan}</div><div>${berlaku}</div></div><div class="info-kanan blood-container"><div class="blood">${darah}</div></div><div class="info-kanan created-location-container"><div class="created-location">${dibuat}</div></div><div class="info-kanan created-date-container"><div class="created-date">${terbuat}</div></div><div class="photo-container"><img src="${photo}" alt="Foto" class="photo"></div><div class="signature">${sign}</div></div></body></html>`
        }, {
            html: (photo, provinsi, kabupaten, nik, nama, ttl, gender, darah, alamat, rt, desa, kecamatan, agama, status, pekerjaan, kewarganegaraan, berlaku, dibuat, terbuat, sign) => `<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><style>@font-face{font-family:'Open Sans Bold';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Bold.ttf') format('truetype')}@font-face{font-family:'Open Sans Regular';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Regular.ttf') format('truetype')}@font-face{font-family:'Bolmand Signature';src:url('https://befonts.com/wp-content/uploads/2025/02/bolmandsignature-0vr8r.ttf') format('truetype')}@font-face{font-family:'Bygone ST Typewriter';src:url('https://befonts.com/wp-content/uploads/2023/01/bygonesttypewriterdemo-4b1dp.otf') format('opentype')}.ktp-container{position:relative;width:735px;height:463px;background-image:url('https://i.pinimg.com/originals/75/d3/80/75d380e895cbb523d9bf990ae7555fdf.jpg');background-size:cover;font-family:sans-serif;color:#000;padding:20px;box-sizing:border-box}.lokasi{position:absolute;top:15px;left:50%;transform:translateX(-50%);text-align:center;font-family:'Open Sans Bold',sans-serif;font-size:28px;line-height:1}.provinsi,.kabupaten{display:block}.nik-value{position:absolute;top:83px;left:155px;font-family:'Bygone ST Typewriter',monospace;font-size:22px}.info-utama{position:absolute;left:225px;top:124px;font-family:'Open Sans Regular',sans-serif;font-size:16px;line-height:1.4;font-weight:700}.info-kanan{position:absolute;right:84px;font-family:'Open Sans Regular',sans-serif;font-size:16px;line-height:1.4;font-weight:700;text-align:center}.blood-container{top:170px;right:230px}.created-location-container{bottom:130px;right:90px}.created-date-container{bottom:110px;right:87px}.blood,.created-location,.created-date{display:block}.photo-container{position:absolute;top:94px;right:35px;width:170px;height:210px;overflow:hidden;border:1px solid #ccc}.photo{width:100%;height:100%;object-fit:cover}.signature{position:absolute;right:95px;bottom:70px;font-family:'Bolmand Signature',cursive;font-size:30px;font-style:italic}</style></head><body><div class="ktp-container"><div class="lokasi"><div class="provinsi">PROVINSI ${provinsi}</div><div class="kabupaten">KABUPATEN ${kabupaten}</div></div><div class="nik-value">${nik}</div><div class="info-utama"><div>${nama}</div><div>${ttl}</div><div>${gender}</div><div>${alamat}</div><div>${rt}</div><div>${desa}</div><div>${kecamatan}</div><div>${agama}</div><div>${status}</div><div>${pekerjaan}</div><div>${kewarganegaraan}</div><div>${berlaku}</div></div><div class="info-kanan blood-container"><div class="blood">${darah}</div></div><div class="info-kanan created-location-container"><div class="created-location">${dibuat}</div></div><div class="info-kanan created-date-container"><div class="created-date">${terbuat}</div></div><div class="photo-container"><img src="${photo}" alt="Foto" class="photo"></div><div class="signature">${sign}</div></div></body></html>`
        }, {
            html: (photo, provinsi, kabupaten, nik, nama, ttl, gender, darah, alamat, rt, desa, kecamatan, agama, status, pekerjaan, kewarganegaraan, berlaku, dibuat, terbuat, sign) => `<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><style>@font-face{font-family:'Open Sans Bold';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Bold.ttf') format('truetype')}@font-face{font-family:'Open Sans Regular';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Regular.ttf') format('truetype')}@font-face{font-family:'Bolmand Signature';src:url('https://befonts.com/wp-content/uploads/2025/02/bolmandsignature-0vr8r.ttf') format('truetype')}@font-face{font-family:'Bygone ST Typewriter';src:url('https://befonts.com/wp-content/uploads/2023/01/bygonesttypewriterdemo-4b1dp.otf') format('opentype')}.ktp-container{position:relative;width:735px;height:477px;background-image:url('https://i.pinimg.com/originals/20/81/cf/2081cf22af8e8b58cc483fc847335532.jpg');background-size:cover;font-family:sans-serif;color:#000;padding:20px;box-sizing:border-box}.lokasi{position:absolute;top:30px;left:50%;transform:translateX(-50%);text-align:center;font-family:'Open Sans Bold',sans-serif;font-size:28px;line-height:1}.provinsi,.kabupaten{display:block}.nik-value{position:absolute;top:108px;left:200px;font-family:'Bygone ST Typewriter',monospace;font-size:22px}.info-utama{position:absolute;left:215px;top:148px;font-family:'Open Sans Regular',sans-serif;font-size:16px;line-height:1.3;font-weight:700}.info-kanan{position:absolute;right:95px;font-family:'Open Sans Regular',sans-serif;font-size:16px;line-height:1.4;font-weight:700;text-align:center}.blood-container{top:189px;right:249px}.created-location-container{bottom:110px;right:95px}.created-date-container{bottom:90px;right:91px}.blood,.created-location,.created-date{display:block}.photo-container{position:absolute;top:130px;right:45px;width:170px;height:210px;overflow:hidden;border:1px solid #ccc}.photo{width:100%;height:100%;object-fit:cover}.signature{position:absolute;right:95px;bottom:50px;font-family:'Bolmand Signature',cursive;font-size:30px;font-style:italic}</style></head><body><div class="ktp-container"><div class="lokasi"><div class="provinsi">PROVINSI ${provinsi}</div><div class="kabupaten">KABUPATEN ${kabupaten}</div></div><div class="nik-value">${nik}</div><div class="info-utama"><div>${nama}</div><div>${ttl}</div><div>${gender}</div><div>${alamat}</div><div>${rt}</div><div>${desa}</div><div>${kecamatan}</div><div>${agama}</div><div>${status}</div><div>${pekerjaan}</div><div>${kewarganegaraan}</div><div>${berlaku}</div></div><div class="info-kanan blood-container"><div class="blood">${darah}</div></div><div class="info-kanan created-location-container"><div class="created-location">${dibuat}</div></div><div class="info-kanan created-date-container"><div class="created-date">${terbuat}</div></div><div class="photo-container"><img src="${photo}" alt="Foto" class="photo"></div><div class="signature">${sign}</div></div></body></html>`
        }, {
            html: (photo, provinsi, kabupaten, nik, nama, ttl, gender, darah, alamat, rt, desa, kecamatan, agama, status, pekerjaan, kewarganegaraan, berlaku, dibuat, terbuat, sign) => `<!DOCTYPE html><html lang="id"><head><meta charset="UTF-8"><style>@font-face{font-family:'Open Sans Bold';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Bold.ttf') format('truetype')}@font-face{font-family:'Open Sans Regular';src:url('https://befonts.com/wp-content/themes/befonts25/custom/fonts/OpenSans-Regular.ttf') format('truetype')}@font-face{font-family:'Bolmand Signature';src:url('https://befonts.com/wp-content/uploads/2025/02/bolmandsignature-0vr8r.ttf') format('truetype')}@font-face{font-family:'Bygone ST Typewriter';src:url('https://befonts.com/wp-content/uploads/2023/01/bygonesttypewriterdemo-4b1dp.otf') format('opentype')}.ktp-container{position:relative;width:1200px;height:800px;background-image:url('https://assets.poskota.co.id/crop/original/medias/2025/Mar/14/nik-ktp.jpg');background-size:cover;font-family:sans-serif;color:#000;padding:20px;box-sizing:border-box}.lokasi{position:absolute;top:80px;left:55%;transform:translateX(-50%);text-align:center;font-family:'Open Sans Bold',sans-serif;font-size:32px;filter:blur(1.1px);line-height:1}.provinsi,.kabupaten{display:block}.nik-value{position:absolute;top:150px;left:350px;font-family:'Bygone ST Typewriter',monospace;font-size:36px;filter:blur(1.1px)}.info-utama{position:absolute;left:352px;top:229px;font-family:'Open Sans Regular',sans-serif;font-size:20px;line-height:1.5;font-weight:600;filter:blur(1.1px)}.info-kanan{position:absolute;right:175px;font-family:'Open Sans Regular',sans-serif;font-size:20px;line-height:1.4;font-weight:600;filter:blur(1.1px);text-align:center}.blood-container{top:287px;right:357px}.created-location-container{bottom:250px;right:155px}.created-date-container{bottom:220px;right:151px}.blood,.created-location,.created-date{display:block}.photo-container{position:absolute;top:192px;right:85px;width:250px;height:318px;overflow:hidden;border:1px solid #ccc}.photo{width:100%;height:100%;object-fit:cover}.signature{position:absolute;right:155px;bottom:140px;font-family:'Bolmand Signature',cursive;font-size:70px;font-style:italic;filter:blur(1.1px)}</style></head><body><div class="ktp-container"><div class="lokasi"><div class="provinsi">PROVINSI ${provinsi}</div><div class="kabupaten">KABUPATEN ${kabupaten}</div></div><div class="nik-value">${nik}</div><div class="info-utama"><div>${nama}</div><div>${ttl}</div><div>${gender}</div><div>${alamat}</div><div>${rt}</div><div>${desa}</div><div>${kecamatan}</div><div>${agama}</div><div>${status}</div><div>${pekerjaan}</div><div>${kewarganegaraan}</div><div>${berlaku}</div></div><div class="info-kanan blood-container"><div class="blood">${darah}</div></div><div class="info-kanan created-location-container"><div class="created-location">${dibuat}</div></div><div class="info-kanan created-date-container"><div class="created-date">${terbuat}</div></div><div class="photo-container"><img src="${photo}" alt="Foto" class="photo"></div><div class="signature">${sign}</div></div></body></html>`
        }];

        const getTemplate = ({ template = 1, photo, provinsi, kabupaten, nik, nama, ttl, gender, darah, alamat, rt, desa, kecamatan, agama, status, pekerjaan, kewarganegaraan, berlaku, dibuat, terbuat, sign }) => {
            const templateIndex = Number(template);
            return templates[templateIndex - 1]?.html(photo, provinsi, kabupaten, nik, nama, ttl, gender, darah, alamat, rt, desa, kecamatan, agama, status, pekerjaan, kewarganegaraan, berlaku, dibuat, terbuat, sign) || "Template tidak ditemukan";
        };

        // --- FUNGSI GENERATOR DATA ACAK ---
        function fillRandomData() {
            const pick = (arr) => arr[Math.floor(Math.random() * arr.length)];
            
            // Kumpulan Data Dummy
            const provinsis = ["JAWA BARAT", "JAWA TENGAH", "JAWA TIMUR", "DKI JAKARTA", "BANTEN", "BALI"];
            const kabupatens = ["BANJARNEGARA", "WONOSOBO", "BANDUNG", "SEMARANG", "SURABAYA", "DENPASAR", "TANGERANG"];
            const namas = ["AGUS SANTOSO", "SITI AMINAH", "HENDRA WIJAYA", "DEWI LESTARI", "EKO PRASETYO", "RATNA SARI", "BUDI KURNIAWAN", "NURUL HIDAYAH"];
            const agamas = ["ISLAM", "KRISTEN", "KATHOLIK", "HINDU", "BUDDHA"];
            const pekerjaans = ["PELAJAR/MAHASISWA", "KARYAWAN SWASTA", "WIRASWASTA", "MENGURUS RUMAH TANGGA", "PEGAWAI NEGERI SIPIL"];
            const statusKawin = ["BELUM KAWIN", "KAWIN", "CERAI HIDUP"];
            const darahs = ["A", "B", "AB", "O", "-"];
            const genders = ["LAKI-LAKI", "PEREMPUAN"];

            const randomNIK = Math.floor(1000000000000000 + Math.random() * 9000000000000000).toString();
            const randomDate = `${String(Math.floor(Math.random() * 28) + 1).padStart(2, '0')}-${String(Math.floor(Math.random() * 12) + 1).padStart(2, '0')}-${Math.floor(1970 + Math.random() * 35)}`;
            const randomRT = `${String(Math.floor(Math.random() * 10) + 1).padStart(3, '0')}/${String(Math.floor(Math.random() * 10) + 1).padStart(3, '0')}`;

            const selectedKabupaten = pick(kabupatens);
            const selectedName = pick(namas);

            document.getElementById('in_provinsi').value = pick(provinsis);
            document.getElementById('in_kabupaten').value = selectedKabupaten;
            document.getElementById('in_nik').value = randomNIK;
            document.getElementById('in_nama').value = selectedName;
            document.getElementById('in_ttl').value = `${selectedKabupaten}, ${randomDate}`;
            document.getElementById('in_gender').value = pick(genders);
            document.getElementById('in_darah').value = pick(darahs);
            document.getElementById('in_alamat').value = `JL. MERDEKA NO. ${Math.floor(Math.random() * 100) + 1}`;
            document.getElementById('in_rt').value = randomRT;
            document.getElementById('in_desa').value = `DESA ${pick(["SUKAMAJU", "MAKMUR", "SEJAHTERA", "HARAPAN"])}`;
            document.getElementById('in_kecamatan').value = `KEC. ${pick(["SELATAN", "UTARA", "BARAT", "TIMUR"])}`;
            document.getElementById('in_agama').value = pick(agamas);
            document.getElementById('in_status').value = pick(statusKawin);
            document.getElementById('in_pekerjaan').value = pick(pekerjaans);
            document.getElementById('in_dibuat').value = selectedKabupaten;
            document.getElementById('in_sign').value = selectedName.split(" ")[0];

            generatePreview();
        }

        // --- FUNGSI RENDER KE IFRAME ---
        function generatePreview() {
            const photoInput = document.getElementById('in_photo');
            
            if (photoInput.files && photoInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    renderIframe(e.target.result);
                }
                reader.readAsDataURL(photoInput.files[0]);
            } else {
                renderIframe('https://via.placeholder.com/150x200?text=FOTO');
            }
        }

        function renderIframe(photoData) {
            const dataKTP = {
                template: document.getElementById('in_template').value,
                photo: photoData,
                provinsi: document.getElementById('in_provinsi').value.toUpperCase(),
                kabupaten: document.getElementById('in_kabupaten').value.toUpperCase(),
                nik: document.getElementById('in_nik').value.toUpperCase(),
                nama: document.getElementById('in_nama').value.toUpperCase(),
                ttl: document.getElementById('in_ttl').value.toUpperCase(),
                gender: document.getElementById('in_gender').value.toUpperCase(),
                darah: document.getElementById('in_darah').value.toUpperCase(),
                alamat: document.getElementById('in_alamat').value.toUpperCase(),
                rt: document.getElementById('in_rt').value.toUpperCase(),
                desa: document.getElementById('in_desa').value.toUpperCase(),
                kecamatan: document.getElementById('in_kecamatan').value.toUpperCase(),
                agama: document.getElementById('in_agama').value.toUpperCase(),
                status: document.getElementById('in_status').value.toUpperCase(),
                pekerjaan: document.getElementById('in_pekerjaan').value.toUpperCase(),
                kewarganegaraan: document.getElementById('in_kewarganegaraan').value.toUpperCase(),
                berlaku: document.getElementById('in_berlaku').value.toUpperCase(),
                dibuat: document.getElementById('in_dibuat').value.toUpperCase(),
                terbuat: document.getElementById('in_terbuat').value.toUpperCase(),
                sign: document.getElementById('in_sign').value
            };

            const resultHTML = getTemplate(dataKTP);
            const iframe = document.getElementById('preview-frame');
            const doc = iframe.contentWindow.document;
            
            doc.open();
            doc.write(resultHTML);
            doc.close();
        }

        // Render pertama kali
        window.onload = () => {
            generatePreview();
        };
    </script>
</body>
</html>
